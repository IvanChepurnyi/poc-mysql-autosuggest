import {createConnection} from 'mysql';
import ngram from 'n-gram';
import faker from 'faker';
const batchSize = 2000;
const brands = ["AA Platinum","Abrand","ABS","Absorba","Absorbine","Abu","Acqua Di Parma","Activision","Adams","Addison Ross","Adidas","adidas by Stella McCartney","adidas Originals","Adrianna Papell","Aero","Aerobie","AG DENIM WOMENS","AG Jeans","Agent Provocateur","AI Riders on the Storm","Airowear","Airwalk","Aladdin","Albam","Albam Utility","Aldo","Alexander McQueen","Alexandre","Allerton","Allies of Skin","AllSaints","Alpha Industries","Alpina","Altaia","ALWAYS RARE","American Tourister","Amigo","And1","Andrew Collinge","Android Femme","Android Homme","Anita","Ann Summers","Anna Sui","Anne Klein","Anon","Anorak","Another Label","Antler","Antony Morato","Anya Hindmarch","Apricot","Apsinal","Aqua Sphere","Aramis","Arcade1Up","ArcadeBaby","Archipelago","Arcminute","Arena","Ariat","Ariella London","Aristoc","Arkk Copenhagen","Arma","Armani","Armani Exchange","Armani Jeans","Aroma Home","Arran Aromatics","Art For The Home","Art Marketing","Arthur Price","Article White","Ash","Ashley and Co","Ashwood","Asics","Asobu","Aspinal of London","Aston and Gunn","Atak","Atari","Atelier Cologne","Athletic Propulsion Labs","Atkinsons","Atomic","Attribute","Aubrion","Audi","Avanti","Aveda","Aviemore","Aynsley","Azendi","Azzaro","Azzurri","b.tempt'd","Babolat","Baby Alive","BaByliss","Back To School","Bad Norwegian","Bakehouse","Balega","Balenciaga","Balling","Balmain","BALR","Ban.do","Bandit Girls","Bar Harbour by Double Two","Barbour","Barbour Alexa Chung","Barbour Beacon","Barbour International","Barbour Lifestyle","Barbour Steve McQueen","Bardot","Bardot Junior","bareMinerals","Barista and Co","Barker","Barrier Animal Healthcare","Barts","Bass Weejuns","Batman","Battle Oats","Battles","Bauer","Baumler","Baxter of California","BBB","BBQ Collection","BCE","Beachcomber","Beats By Dr Dre","Beckham","Bedeck of Belfast","Bedhead","Bedroom Athletics","Beldray","Bella Dahl","Bellapierre","Belleek Living","Belstaff","Ben Sherman","Bench","Benefit","Benetton","Benross","Bentley","Berghaus","Berghoff","Berkley","Berndes","Bertie","Berwin and Berwin","Bestway","Betty and Co","Betty Barclay","Beyonce","Bialetti","Biba","Bibi Bijoux","Big Potato","Bikkembergs","Billabong","Billieblush","Billybandit","Birgitte Herskind","Birkenstock","Bjorn Borg","Black and Blum","Black Diamond","Black Zero","Blake Seven","Blank Canvas","Blazer Pro","Blend Oud","Blenheim","Blink","BLK","Blomus","Blood Brother","Bloomingville","Blowfish","Blue Planet","Blue Sky Studios","Bluebella","Blush","Boardies","Bobbi Brown","Bobble","Bodum","Body Frock","Bonds","Bookspeed","Boot Buddy","Boot doc","Bootclaw","Boss","Boss Athleisure","Boss Bodywear","Boss Business","Boss Casual","Boss Smart Casual","Bottega Veneta","Boutique Home","Boutique Kitchen","Boutique Luxury Wallpaper","Boutique Moschino","Bouton","Brabantia","Brakeburn","Braun","Bread and Butter","Brecrest","Breville","Brics","Bridget's Brollies","Brinkhaus","Brita","British Knights","British Tailor","Brixton","Brogini","Bronnley","Bronx","Brut","BSL","Buckley London","Buffalo","Bugatti","Bullfrog","Bumble And Bumble","Burberry","Burberry Brit","Busse","Butterfly","Bvlgari","By Malene Birger","BYBI","Cadbury","Caldene","Callaway","Calvin Klein","Calvin Klein 50","Calvin Klein Golf","Calvin Klein Jeans","Calvin Klein Menswear","Calvin Klein Performance","Calvin Klein Tailoring","Cam Cam Copenhagen","Caman","Cambridge","Camper","Campingaz","Campo Marzio","Campri","Candyhouse","Canterbury","Capri Blue","Carhartt","Carlton","Carolina Cavour","Carolina Herrera","Carp Kinetics","Carr Day Martin","Carrement Beau","Carrera","Carrots","Carter","Cartier","Cartwright and Butler","Carvela","Carvela Comfort","CASA","Casio","Caterpillar","Cateye","Cath Kidston","Catimini","Cavallo","Champ","Champion","Champion Body Protectors","Champion Hats","Champion X BEAMS","Chantelle","Character","Charles Owen","Charlotte Tilbury","Charnos","Chase and Wonder","Chasing Summer","Chavin","Cheap Monday","Chef Aid","Chelsea Cobbler","Chelsea Peers","Chesca","Chester Barrie","Chi Chi","Chillaz","Chipmunks","Chloe","Choc on Choc","Chopard","Christy","Chub","Church","Churchs","Ciclo Sport","Ciesse Piumini","Cimac","Clairol","Claremont","Clarins","Clarissa Hulse","Clementoni","Cleveland","Clinique","Clip Fresh","Coach","Coast","Cobra","Coldstream","Cole Haan","Coleman","Coles","Coll Tex","Collegiate","Colmar","Columbia","Coma Toes","Command","Commando","Comme des Garcons","Compressport","Continental","Converse","Converse Lifestyle","Cool Gear","Corkcicle","Cornishware","Corsivo","Cosmic","Cosy Pony","Cotswold","Cottage Craft","Cover FX Skin Care","Covert Overt","Coyote","CP Company","Crafted","Crafted Essentials","Crafted Mini","Craghoppers","Crayola","Crea Concept","Creative Recreation","Creed","Crew Clothing Company","Criminal","Criminal Damage","Cristiano Ronaldo","Crocs","Cruyff","Culcita","Curvy Kate","Cyberjammies","D and G","D555","Daewoo","Daily Dining","Dainese","Dainty and Heaps","Dalmar","Damsel in a Dress","Dansk Smykkekunst","Dare2b","Darling","Darphin","David And Goliath","David Barry","Davidoff","Day ET","DC","DC Comics","De Rosa","Dead Legacy","Deathwish","Delonghi","Delray","Delsey","Denby","Dents","Dermoline","Descente","Designer","Designers Guild","Desigual","Deuter","Dexam","DGK","Diadora","Diamond Supply Co.","Diamondback","Diane Von Furstenberg","Dickies","Dickins and Jones","Diem","Diesel","Diesel Jeans","Dior","Dior Backstage","Dior Prestige","Disney","Djubi","DKNY","DKNY Occasion","DKNY Sport","Dolce and Gabbana","Donna Karan","Donna Wilson","Donnay","Dorina","Dorothy Perkins","Double TWO","Dr Denim","Dr Paw Paw","Dream Rider","Dropshot","DSquared2","Dualit","Dublin","Dune","Dune Black","Dune London","Dunhill","Dunlop","Duracell","Dwyers and Co","Dyberg Larsen","Dynafit","EA","EA SPORTS","EA7","Eastern Mountain Sports","Eastpak","Eberjey","Ecco","Echo","Ed Hardy","Eddy Toys","Edelrid","Eden Park","Edinburgh Preserves","Edward Goddard","Eight and Bob","Eisbar","Ektelon","Elbeo","Element","Elemis","Elie Saab","Eliza J","Elizabeth Arden","Elle","Elle Macpherson Body","Ellesse","Emerica","Emily Bond","Emma Bridgewater","Emma J Shipley","Emme","Emoji","Emporio Armani","England Cricket","England Hockey","Equetech","Equilibrium","Equine America","Equi-Ping","Equisafety","Erbo","Erborian","Ergon","Erima","Escada","Eskadron","Esprit","Estee Lauder","Estee Lauder Nutritious","Estee Lauder Re-Nutriv","Eton","EuroHockey","Eurostar","Everlast","Excellent Houseware","EXG","Extremities","Eylure","Ezi-Groom","F and B","Fab Lab","Faber Castell","Fabienne Chapot","Fable","Fabric","Fabris Lane","Falke","Fantasie","Farah","Farah Classic","Farah Sport","Farah Vintage","Fashion Union","Fat Face","FC Barcelona","FCUK","Fearless Illustration","Feber","FENCEMAN","Fendi","Fenn Wright Manson","FENTY PUMA by Rihanna","Ferrari","Fervor Montreal","Festive","Feud","FIFA","Figleaves","Fila","Filling Pieces","Filorga","Fine Bedding","Finish Line","Fiorelli","Firetrap","First","Fischer","FitFlop","Five","Flair Rugs","Flannels Black Label","Flights of Fancy","Florale","Floralsilk","Flossy","Fly Away","Fly London","Foamie","Folk","Folli Follie","Footbalance","Footjoy","For All Mankind","Ford","Foreo","Fossil","Foxiedox","Fragranced Firestarter","Frame","Frank Wright","Franklin and Marshall","Fred Perry","Frederic Malle","Free People","Freedom","Freeloader","French Connection","French Linens","Fresh Ego Kid","Freya","Freya Sport","Frock and Frill","Full Circle","Fulton","Funkita","Funko","Furla","Fyna Lite","G Form","Gabor","Gallery Direct","Galvin Green","Galway","Galway Crystal","Gamesson","GANT","Garden Essentials","Garmin","Garmont","Gatorade","Gelert","Gentlemen's Hardware","George Foreman","Geox","Gestuz","GFS","GHD","Gibbon","Gibson","Gift","Gift Republic","Gilbert","Giles and Posner","Gimi","Gina Bacconi","Ginger Fox","Ginia","Gio Goi","Giorgio","Giorgio Armani","Gipsy","Girls on Film","Giro","Gisela Graham","Giuseppe Zanotti","Givenchy","Glamglow","Glamorous","Global Herbs","Globber","Globe","Glove Glu","Go Travel","Gola","Golddigga","Golf Pride","Goliath Games","Good For Nothing","Good Grips","Goorin Brothers","GoPro","Gore","GORILLA BROOM","Goutal","Grace Home","Grafix","Graham and Brown","Grange","Gray and Willow","Gray Nicolls","Grays","Great Plains","Green and Blacks","Green Pan","Grenade","Grenson","Greys","Grizzly","Groom Away","GRUNDIG","G-Star","GU","Gucci","Guerlain","Guess","Gul","Gunn And Moore","H By Hudson","H20 Swim","Habitat","Hac Tac","Hackett","Hagan","Hailey Logan","Hallhuber","Hamax","Hamleys","Happy Hop","Happy Jackson","Happy Plugs","Happy Sammies","Happy Socks","Happy Zoo","Hardcore","Harlequin","Harrod","Harrows","Hasbro","Hatchwells","Havaianas","Havren","Hay Play","HEAD","Head Over Heels","Heat Holders","Heath","Heatons","Hebie","Hedgren","Hedstrom","Heelys","Heidi Klum","Helen McAlinden","Helen Moore","Helena Springfield","Helly Hansen","Helmut Lang","Help for Heroes","Henri Lloyd","Heritage","Hermano","Hermes","Herschel","Herschel Supply Co","Hi Tec","High","High 5","Highland","Highlander","Hilfiger Collection","Hilfiger Denim","Hi-Lite","Hilly","HIP","HKT","Hobbs","Hollister","Home and Styling","Homsire","Horizont","Horse Couture","Horse First","Horsemens Pride","Horseware","Hot Milk","Hot Tuna","Hotel Collection","Hotline","HotSquash","Hotter","House of Dorchester","House of Fraser","Howick","Howick Junior","Howick Tailored","Howler and Scratch","HT","Hudson","Hudson Jeans","Hugo","Hugo Boss","Huit","Hummel","Humpert","Hunter","Hurlingham Polo 1875","HURLINGHAM POLO 1875 TAILORED","Hush Puppies","Hy","Hydrea","Hydro Zone","Hydrophane","HyHealth","Hymn","Hype","Hyper","Iblues","Icart","Ice Master","Iconic London","IFlow","IL SARTO","Infinity and Co","Ingersoll 1892","Innova","Inspire","Intempo","Interplay","Intex","Invisibobble","Inyati","Ironman","ISC","Isotoner","ISSA","Issa London","Issey Miyake","IT Luggage","iTech","Ivy and Oak","IVY Copenhagen","Izabel","IZOD","J Brand","Jack and Jones","Jack Black","Jack Murphy","Jack Wills","Jack Wolfskin","Jaded London","James Lakeland","Jarlo","JBL","JCB","JCUK","JDY","Jean Paul Gaultier","Jeans Intelligence","Jefferey West","Jeffery West","Jeffrey Campbell","Jersey Pearl","Jessica Wright","Jets","Jigsaw","Jill Jill Stuart","Jilted Generation","Jimmy Choo","JML","Jo Malone London","Joe and Sephs","Joes Jeans","John Adams","John Deere","John Galliano","John Whitaker","Jolie Moi","Joma","Jonathan Aston","Jonathon Charles","Joolz","Joop","Joseph","Joseph Joseph","Joules","JRC","JS Collections","JUICE","Juicy","Juicy Couture","Julian Charles","Jumpking","Junipa","Just Cavalli","Just Joan","Just Sheepskin","Just Togs","JVL TRADEU","K Swiss","K Swiss Classics","K100 Karrimor","K2","Kaemingk","KangaRoos","Kangol","Kappa","Karakal","Karen Millen","Karl Lagerfeld","Karrimor","Karrimor K100","Kate Spade","Kate Spade New York","Katy Perry","Kaytie Wu","Keepsake","Kelme","Kendall and Kylie","Kenneth Cole","Kensie","Kensington","Kent and Curwen","Kenwood","Kenzo","KERATEX","Kettler","Kevlar","KeyLargo","KG","KG Kurt Geiger","Kickers","Kidney Karen","Kiefer","Kiehls","Kilian","Kilner","Kincade","Kings Will Dream","Kingsland","Kingsley","Kipling","Kitchen Craft","Kitchen Pantry","KitchenAid","Kite","KJUS","Kleeneze","KMC","Knomo","Kodak","Komperdell","Konjac Sponges","KooGa","Kookaburra","Koolpak","Kork","Korsteel","Kraft Paper","Kreafunk","Kross","Krups","Kryptonics","KT Tape","Kukri","Kurt Geiger","Kurt Geiger London","Kylie Minogue","L Agent by Agent Provocateur","La Cerise","La Cristallerie des Parfums","LA Gear","La Mer","La Prairie","La Residence","LaBante","Label Lab","Lacoste","Lacoste Bodywear","Lambretta","Lamkin","Lamy","Lancaster","Lancome","Lanvin","Lara Heems","Laura Mercier","Laurel","Lauren","Lauren by Ralph Lauren","Lauren Ralph Lauren Bodywear","Lauren Ralph Lauren Occasion","Lavender and Lillie","Le Coq Sportif","Le Creuset","Lee","Lee Cooper","Lee Jeans","Lego","Lego Wear","Leki","Lelli Kelly","LeMieux","Leovet","Lepel","Levi's","Libertine Libertine","Life Venture","LifeSystems","Lifetime Garden","Likit","Lilliput and Felix","Limehaus","Limited Sports","Lincoln","Linea","Linens and Lace","Lipault","Lipsy","Little Dickins and Jones","Little Joule","Little Marc Jacobs","Little Mistress","Little White Lies","Liveryman","Loake","Loakes","L'Occitane","Löffler","LOL","Lola and Grace","Lola Rose","Lollys Laundry","Lonna and Lilly","Lonsdale","Lorna Jane","Lotus","Lotus Shoes","Love Moschino","Loveson","Loyalti","Loyalty and Faith","LRG","LSA","Lucozade","Luke","Luke 1977","Luke Sport","Lulu and Nat","Lulu Guinness","Luminara","Lund London","Luub","Luvley at Hamleys","Lyle and Scott","Lyle and Scott Sport","M by M","M by Moda","M Missoni","M.Y","M·A·C","Ma Strum","Mackage","Macron","Magic Bodyfashion","Magnanni","Maidenform","Maidenform Accessories","Maison De Nimes","Maison Lejaby","Maison Margiela Paris","Maison Scotch","Makura","Malini","Mango","Marc Aurel","Marc Jacobs","Marc O'Polo","Marella","Marina","Mario Valentino","Marmot","Marram Co","Mars","Marshall","Marshall Artist","Maru","Marvel","Maserati","Mason Cash","Mason Knight Yager","Masta","Masters","Masuri","Mattel","Maver","Max Mara","Max Mara Studio","Max Mara Weekend","Maxxus","McLaggan","MCM","McQ Alexander McQueen","Mega Value","Mela","Mela London","Mela London Curve","Melissa","Merc","Mercedes","Mercer","Merrell","Met","MFT","Michael Kors","MICHAEL Michael Kors","Michael Phelps","Michelin","Microsoft","MightyMast","Mikasa","Millet","Minene","Mini Melissa","Mini Miss KG","Mini Vanilla","Minimum","Mink Pink","Minky","Minnetonka","Mint Velvet","Mio","Miso","Miss Fiori","Miss KG","Missoni","Mitre","Miu Miu","Mizuno","MLS","Moda in Pelle","Molten","Molton Brown","Moments of Light","Money","Monkee Genes","Monkey Monkey","Monsoon","Mont Blanc","MORETTA","Morgan","Morris and Co","Moschino","Motive Fitness","Mountain Hardwear","Movement","Mr Lacy","MRF","MSGM","Muck Boot","Muddyfox","Mugler","Mulberry","Murad","Murdock","Murmur","Musto","MVMT","My Fairy Garden","My View","NAF","NA-KD","Nalgene","Nancy Ganz","Napapijri","Napapijri Futurewear","Napapijri Tribe","Narciso Rodriguez","Nars","Nathan","National","Native Union","Native Youth","Naturalizer","Nautica","NCLA","Nerf","Nespresso","Nettex","Nevica","New Balance","New County","New Era","New York","NFL","NHL","Nibbling","Nicce","Nike Golf","Nikwax","Nimes","Nina Ricci","Nine West","Ninja","Nintendo","NIOD","Nite Ize","No Fear","no name","Noisy May","Nooco","Noodoll","Noose and Monkey","Nora Rose","Nordica","Nordlux","North Parade","Nougat","Nubian Skin","NUFC","NVME","NYDJ","Oakley","Oasis","Oatein","Odlo","Official","Olga Berg","Oliver Sweeney","Olivia Burton","Olivier Desforge","Olivier Desforges","Ollie and Nic","O'Neill","ONeills","Only","Only and Sons","Opro","Origin Rugs","Original Penguin","Origins","Orla Kiely","Ortovox","Oscar Jacobson","Osiris","Oui","Outline","Outwell","Paco Rabanne","Padamo","Pairs In Paris","Paladone","Panasonic","Pantofola d Oro","Pantone","Paradigm","Parajumpers","Parallax","Parfums De Marly","Parker","Parks London","Parlane","Part Two","Partymor","Patchology","Patrick","Patrizia Pepe","Paul And Shark","Paul And Shark Crew","Paul Edward","Paul Green","Paul Smith","Paul Smith Tailoring","Paul Smith Underwear","Paw Patrol","Payntr","Pearl Izumi","Peeroton","Penfield","Penguin","Penhaligons","Penny","People Tree","Pepe Jeans","Peppa Pig","Perry Ellis","Perseverance","Perseverance London","Persol","Persona","Pet Brands","Peter Rabbit","Petit Collage","Pettifers","Petzl","Phase Eight","Pieces","Pied a Terre","Pierre Cardin","Pifco","Pikeur","Pilgrim","Pixi","Plant Apothecary","Plantation Rug Co.","Platinum","Play-Doh","Plum","Plumen","Ply Tech","POD","Polar","Polar Gear","Polo","Polo Ralph Lauren","Polo x Wimbledon","Pomoca","Porsche","Portmeirion","PowerA","Prada","Prada Linea Rossa","Precision Training","Premier","Premier Decorations","Presidents Club","Prestat","Pretty Green","Pretty Polly","Pride","Primitive","Prince","Pringle","Pro Performance","Pro Tec","Prochef","Pro-Fade","Professor Puzzle","Profound Aesthetic","Pro-Gardens","Project Me","Protein World","Proverb","PS By Paul Smith","PTP","Puckababy","Puffa","Pulp","Pulse7","Puma","Pyrenex","Pyrex","Quentin Blake","Quick","Quicksilver","Quiksilver","Qupid","Rachel Zoe","Racing Green","Racktime","Radial","RADIOL","Radley","Rag and Bone","Raging Bull","Rainbow Club","Raleigh","Ralph Lauren","Ralph Lauren Home","Ralph Lauren Sunglasses","Rambo","Rastar","Ravel","Ravenhead","Ray-Ban","RCR","Readers","Red 5","Red Bull","RED GORILLA","Reebok","Reebok Lifestyle","Regatta","Regenerate","Religion","Remington","Replay","Requisite","Reusch","Revelation","RFU","Rhino","Richard James","Ridge 53","Ridleys","Riley","Rita Ora Home","Robert Fredrick","Roberto Cavalli","Roberto Vianni","Robinson Animal Healthcare","Robinsons","Roces","Rock and Rags","Rock and Wilde","Rocket Dog","Rockies","Rockin' Baby","Rockport","Rockstar Games","Roeckl","Roger and Gallet","Roland Cartier","Rolleat","Rollerblade","Rolly","Roma","Roman Originals","Ron Hill","Rookie","Roscomar","Rose and Wilde","Rose London","Roxy","Royal Albert","Royal Doulton","Royal Selangor","Rrixen and Kaul","Rubber Road","Rugby World Cup","RugGuru","Rushmore","Russell Athletic","Russell Hobbs","Ryans World","S By Sloggi","SA AL and CO","Sacrifice","Safejawz","Sage","Sak","Salewa","Salming","Salomon","Salsa","Salter","Salvatore Ferragamo","Sam Edelman","SAMBA","Samsoe and Samsoe","Samsonite","Sanderson","Sandwich","Sandy Bay","Sara Miller","Sara Miller for Portmeirion","Sarasota","Sartoria Tramarossa","Saucony","Saucony Originals","SAV","Saxon","Scaramouche","Scatch","Scholl","School Of Wok","Schwalbe","Scion","Score Draw","Scotch and Soda","Scott and Taylor","Scruffs","SE Sports Equipment","Seafolly","Seaspray","Sebago","Second Female","See By Chloe","Selected Femme","Selected Homme","Selle Royal","Selsport","Serge Lutens","Sergio Tacchini","Sessun","SET","Seymo","SF","Shake Junt","Shakespeare","Shanghai Tang","SHAQ","Sheaffer","Shepherd of Sweden","Sheridan","Shifa Aromas","Shimano","Shires","Shiseido","Shock Absorber","Shock Doctor","Shorso","Show","Sian Marie","Sidewalk Sport","Sigma","SikSilk","SIL","Silent Night","Silstar","SILVERLIT","Simon Carter","Simplehuman","Sis","Sisley","Sistaglam","Sistaglam loves Jessica","Sistema","Sixth June","Skagen","Skechers","Skinny Dip","Skins","Skopes","SkyCaddie","Slappie","Slazenger","Slazenger Banger","Slogger","Sloggi","Slydes","Smart","Smart and Joy","Smart Choice","Smarts","Snickers","Snowtrax","Sofie Schnoor","Softspikes","Solar Essentials","SoloGroom","Soma","Sondico","Sonia Rykiel","Sophia Webster","Sophie Allport","Sophie Conran for Portmeirion","Sorel","SoulCal","Source Lab","Soviet","Spalding","Spanx","Spartan","Speedo","SPERRY","Spillers","Spin Master","Sportalm","Sportech","SportFX","Sportmax","Sportmax Code","Sports Beans","Sports Craft","Spyder","Srixon","Stance","Stand Studio","Stanford Home","Star","Star Wars","StarSkin","Starter","Stationary Shop","Staub","Steeplechase Manor","Stefanel","Stella McCartney","Stemar","Steve Madden","Stewarts","Stila","Stojo","Stonefly","Storm","StormBloc","Strata","Stubbs","Stud Muffins","Studio 8","Stutterheim","Subbuteo","Sublime","Sugoi","Suncoo","Sunday of London","Sunice","Sunnylife","SUNSEEKER","Sunuva","Sunwise","Super Codlivine","Super Stroke","Super Wings","Superdry","SuperFit","Superfresco Easy","Superga","Supreme Products","Sushi","Suuna","Suunto","Suzanne Bettley","Swallows and Daggers","Swarovski","Sweed","Swim Shop","Swims","Swiss Cross by Strellson","Swiss Military","T3","Tadashi Shoji","Take Off","Tala","Talulah","Tapout","Tateossian","Tatonka","TaylorMade","Team","Ted Baker","Tefal","Tekna","Tempest Original","Terry De Gunzburg","Teva","tfnc","The East Order","The Flexx","The Merchant Of Venice","The North Face","The Ordinary","The Soft Bedding Company","The Very Warm","Theory","Therapy","Therapy London","Thermos","Theya Healthcare","THEYE","Thomas Royall","Thomas Sabo","Three Floor","Tiffany","Tiger of Sweden","Tiger of Sweden Jeans","Tiger Tail","Timberland","Timex","Titleist","TM Lewin","Toby Tiger","Tog 24","Toggi","Toko","Tom Ford","Tommy Bodywear","Tommy Hilfiger","Tommy Hilfiger Tailoring","Tommy Jeans","Tommy Sport","Tommy x Lewis Hamilton","Tommy x Rossignol","Toms","Tonic","Tonka","Tony Hawk","Tony Moly","Topeak","Topway","Torpey","Tory Burch","Totes","Tournagrip","Tower","Toy Shop","TP Toys","TPPE","Training Zone","Travalo Milano","Tritan","Triumph","Triumph and Disaster","Trolls","True Religion","Trusox","Trussardi","Trust","TSG","Tubtrugs","Turner and Sanderson","Turtle Beach","Tutti and Co","Twenty","Twist and Tango","Twisted Tailor","TY","Tyr","U.S. Polo Assn.","Ubisoft","UGG","Uglies","Uhlsport","Ultra Sun","Ultralight","Umbro","Unbranded","Uncut","Under Armour","Unibond","Unicorn","Unknown","UNO Fitness","Upcircle Beauty","Urban Apothecary","Urban Decay","USA Pro","USA Pro by Matthew Williamson","USC","USG","USN","V and A","Vago","Valeur Absolu","Van Cleef and Arpels","Vanilla Blanc","Vanquish","Vans","Vaude","Velvet","Vera Mont","Veredus","Vero Moda","Versace","Versace Jeans","Versace Jeans Couture","Versus Versace","Verte Vallee","Vespa","VEX","Victoria Beckham","Victoria by Victoria Beckham","Victoria Victoria Beckham","Victorias Secret","Viktor and Rolf","Vila","Vilebrequin","Villeroy and Boch","Vince","Vince Camuto","Viners","Vintage playing cards","Viski","Vist","Vita Liberata","Vitt","Vittoria","Vivien Sheriff","Vivienne Westwood","Vivienne Westwood Accessories","Vivienne Westwood X Melissa","Vix Swimwear","VOG","Vogue","Volcom","Völkl","Voluspa","Von Dutch","Vorgee","Vulkan","VX-3","Wacky Sox","Wacoal","Waggy Tails","Wahl","WaiKoa","Wallis","Warehouse","Warner","Warner Brothers","Warrior","Watercult","Waterford","Wax Lyrical","Weatherbeeta","Wedgwood","Wedgwood Harlequin Collection","Weekend Offender","Wendy Hallett Womens","Wessex","Westend By Simon Carter","What","Whistles","White Gold Rugby","Wild About Beauty","Wild and Wolf","Wild Country","Wildfeet","Wilson","Windsor Smith","Winmau","Winners","Winser London","Wolf","Wolford","Wombat and Co","Wonderbra","Woof Wear","Wrangler","WWE","X Blades","X Treme","Yadah","YAS","Yes Chef","Yoga Mad","Yonex","Young Versace","YSL","Yulu","Yumi","Yumi Curves","Yumi Girls","Yves Delorme","Yves Saint Laurent","Zadig and Voltaire","Zero","Ziener","Zinc","Zlatan Ibrahimovic","Zodiac","Zoe Karssen","Zoggs","Zone Denmark","Zone3","Zukie","Zwilling","Zyliss","11 Degrees","2K Games","3 Pommes","31st State","7 For All Mankind","72 Hair","883 Police"];

function quoteIdentifier(identifier) {
    return '`' + identifier + '`';
}

export function createMultiInsertStatement(table, fields, rowCount) {
    const fieldList = fields.map(quoteIdentifier).join();
    const placeHolder = fields.map(() => '?').join();
    const rows = `(${placeHolder}),`.repeat(rowCount);

    return `INSERT IGNORE INTO ${quoteIdentifier(table)} (${fieldList}) VALUES ${rows.substr(0, rows.length-1)}`;
}

export function *productObjectGenerator(numberOfRecords) {
    for (let i = 1; i <= numberOfRecords; i ++) {
        const adjective = faker.commerce.productAdjective();
        const material = faker.commerce.productMaterial();
        const type = faker.commerce.product();

        yield {
            sku: 'SKU' + i,
            name: `${adjective} ${material} ${type}`,
            type: type,
            material: material,
            price: faker.commerce.price(),
            brand: faker.random.arrayElement(brands)
        };
    }

}

export default function (connectionSettings) {
    const connection = createConnection(connectionSettings);

    return {
        generateRecords(totalRecords) {
            const dataGenerator = productObjectGenerator(totalRecords);

            const onEachQuery = (err) => {
                if (err) throw err;

                if (totalRecords <= 0) {
                    connection.end();
                    return;
                }

                const productData = [];
                const suggestionData = [];

                const rowsToAdd = Math.min(batchSize, totalRecords);
                for (let i = 0; i < rowsToAdd; i ++) {
                    let product = dataGenerator.next().value;
                    productData.push(product.sku, product.name, product.price, product.brand)
                    let suggestion = `${product.brand} ${product.material} ${product.type}`;
                    suggestionData.push(suggestion, ngram.trigram(suggestion).join(' '));
                }

                totalRecords -= rowsToAdd;
                connection.query(
                    {
                        sql: createMultiInsertStatement('products', ['sku', 'name', 'price', 'brand'], rowsToAdd),
                        values: productData
                    },
                    (err) => {
                        if (err) throw err;

                        connection.query(
                            {
                                sql: createMultiInsertStatement(
                                    'product_suggestions', ['suggestion', 'trigram'], rowsToAdd
                                ),
                                values: suggestionData
                            },
                            onEachQuery
                        )
                    }
                )
            }
            connection.connect(() => {
            });

            onEachQuery();
        },
        suggestKeywords(keyword) {
            const trigram = ngram.trigram(keyword).join(' ');
            let startTime;
            connection.connect(() => {
                startTime = new Date();
            });
            connection.query({
                sql: 'SELECT suggestion, MATCH (trigram) AGAINST (? IN NATURAL LANGUAGE MODE) as score FROM product_suggestions WHERE MATCH(trigram) AGAINST(? IN NATURAL LANGUAGE MODE) LIMIT 5',
                values: [trigram, trigram]
            }, (err, result) => {
                console.log('Query time: ' + (((new Date()).getTime() - startTime.getTime())/1000) + 's');

                for (let item of result) {
                    console.log('Suggestion: ' + item.suggestion + ', score: ' + item.score)
                }


                connection.end()
            })
        }
    };
}

